# Lesson 1: What is Caching? - Ù…Ø§ Ù‡Ùˆ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø¤Ù‚ØªØŸ âš¡

<div dir="rtl">

## Ø§Ù„Ù…Ù‚Ø¯Ù…Ø©

**Caching** Ù‡Ùˆ ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© Ø¨ÙƒØ«Ø±Ø© ÙÙŠ Ù…ÙƒØ§Ù† Ø³Ø±ÙŠØ¹ Ø§Ù„ÙˆØµÙˆÙ„ØŒ Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø¬Ù„Ø¨Ù‡Ø§ Ù…Ù† Ø§Ù„Ù…ØµØ¯Ø± Ø§Ù„Ø£ØµÙ„ÙŠ ÙƒÙ„ Ù…Ø±Ø©.

**Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©:** 20 Ø¯Ù‚ÙŠÙ‚Ø©

</div>

---

## ğŸ“Š Real-World Analogy

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Caching in Real Life                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  Ø¨Ø¯ÙˆÙ† Cache (Ø§Ù„Ù…ÙƒØªØ¨Ø©):                                               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                             â”‚
â”‚  ÙƒÙ„ Ù…Ø§ ØªØ­ØªØ§Ø¬ Ù…Ø¹Ù„ÙˆÙ…Ø© â†’ ØªØ±ÙˆØ­ Ø§Ù„Ù…ÙƒØªØ¨Ø© â†’ ØªØ¯ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„ÙƒØªØ§Ø¨               â”‚
â”‚  â†’ ØªÙØªØ­Ù‡ â†’ ØªÙ‚Ø±Ø£ â†’ ØªØ±Ø¬Ø¹ Ø§Ù„ÙƒØªØ§Ø¨                                       â”‚
â”‚  â±ï¸ Ø§Ù„ÙˆÙ‚Øª: 30 Ø¯Ù‚ÙŠÙ‚Ø© Ù„ÙƒÙ„ Ù…Ø¹Ù„ÙˆÙ…Ø©!                                     â”‚
â”‚                                                                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                      â”‚
â”‚  Ù…Ø¹ Cache (Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙƒØªØ¨):                                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                   â”‚
â”‚  Ø§Ù„ÙƒØªØ¨ Ø§Ù„Ù…Ù‡Ù…Ø© Ù…ÙˆØ¬ÙˆØ¯Ø© Ø¹Ù„Ù‰ Ù…ÙƒØªØ¨Ùƒ                                       â”‚
â”‚  â†’ ØªÙØªØ­ Ø§Ù„ÙƒØªØ§Ø¨ â†’ ØªÙ‚Ø±Ø£ Ù…Ø¨Ø§Ø´Ø±Ø©                                        â”‚
â”‚  â±ï¸ Ø§Ù„ÙˆÙ‚Øª: Ø«Ø§Ù†ÙŠØ© ÙˆØ§Ø­Ø¯Ø©!                                             â”‚
â”‚                                                                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                      â”‚
â”‚  ğŸ¯ Ø§Ù„Ù€ Cache = Ø§Ù„Ù…ÙƒØªØ¨ (Ø³Ø±ÙŠØ¹ Ù„ÙƒÙ† Ù…Ø³Ø§Ø­ØªÙ‡ Ù…Ø­Ø¯ÙˆØ¯Ø©)                      â”‚
â”‚  ğŸ“š Ø§Ù„Ù€ Database = Ø§Ù„Ù…ÙƒØªØ¨Ø© (Ø¨Ø·ÙŠØ¡ Ù„ÙƒÙ† ÙÙŠÙ‡Ø§ ÙƒÙ„ Ø´ÙŠØ¡)                   â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1ï¸âƒ£ Cache Hit vs Cache Miss

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Cache Hit vs Miss                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  Cache Hit (Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Cache) âœ…                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  Request   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  Found!   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚ Client â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Server â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Cache  â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚       â–²                     â”‚                    â”‚                  â”‚
â”‚       â”‚                     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚       â”‚                     â”‚     Data                              â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â”‚             Response (Fast!)                                        â”‚
â”‚                                                                      â”‚
â”‚  â±ï¸ Time: ~1-5ms                                                    â”‚
â”‚                                                                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                      â”‚
â”‚  Cache Miss (Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©) âŒ                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                   â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  Request   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  Not Found â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ Client â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Server â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Cache  â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚       â–²                     â”‚                                       â”‚
â”‚       â”‚                     â–¼                                       â”‚
â”‚       â”‚                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚       â”‚                â”‚   DB   â”‚  Query                            â”‚
â”‚       â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
â”‚       â”‚                     â”‚                                       â”‚
â”‚       â”‚                     â–¼                                       â”‚
â”‚       â”‚                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚       â”‚                â”‚ Cache  â”‚  Store for next time             â”‚
â”‚       â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
â”‚       â”‚                     â”‚                                       â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â”‚             Response (Slow)                                         â”‚
â”‚                                                                      â”‚
â”‚  â±ï¸ Time: ~100-500ms                                                â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Key Metrics

```go
// Cache Hit Rate = (Cache Hits / Total Requests) Ã— 100%

// Example:
// 1000 requests
// 800 cache hits
// 200 cache misses

hitRate := float64(800) / float64(1000) * 100  // 80%

// Good hit rates:
// > 90%  = Excellent
// 80-90% = Good
// 70-80% = Acceptable
// < 70%  = Needs improvement
```

---

## 2ï¸âƒ£ Types of Cache

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Types of Cache                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  1. In-Memory Cache (Ø¯Ø§Ø®Ù„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚)                                   â”‚
â”‚     â”œâ”€ Go map, sync.Map                                             â”‚
â”‚     â”œâ”€ Very fast (nanoseconds)                                      â”‚
â”‚     â”œâ”€ Limited to single instance                                   â”‚
â”‚     â””â”€ Lost on restart                                              â”‚
â”‚                                                                      â”‚
â”‚  2. Distributed Cache (Ø®Ø§Ø±Ø¬ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚)                                 â”‚
â”‚     â”œâ”€ Redis, Memcached                                             â”‚
â”‚     â”œâ”€ Fast (milliseconds)                                          â”‚
â”‚     â”œâ”€ Shared across instances                                      â”‚
â”‚     â””â”€ Persists across restarts                                     â”‚
â”‚                                                                      â”‚
â”‚  3. HTTP Cache (ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­/CDN)                                      â”‚
â”‚     â”œâ”€ Browser cache                                                â”‚
â”‚     â”œâ”€ CDN cache                                                    â”‚
â”‚     â”œâ”€ Controlled via headers                                       â”‚
â”‚     â””â”€ Best for static content                                      â”‚
â”‚                                                                      â”‚
â”‚  4. Database Cache (Ø¯Ø§Ø®Ù„ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª)                             â”‚
â”‚     â”œâ”€ Query cache                                                  â”‚
â”‚     â”œâ”€ Buffer pool                                                  â”‚
â”‚     â””â”€ Managed by DB automatically                                  â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1. In-Memory Cache (Simple Go Example)

```go
package cache

import (
    "sync"
    "time"
)

type CacheItem struct {
    Value      interface{}
    Expiration time.Time
}

type InMemoryCache struct {
    items map[string]CacheItem
    mu    sync.RWMutex
}

func NewInMemoryCache() *InMemoryCache {
    cache := &InMemoryCache{
        items: make(map[string]CacheItem),
    }
    // Start cleanup goroutine
    go cache.cleanup()
    return cache
}

func (c *InMemoryCache) Set(key string, value interface{}, ttl time.Duration) {
    c.mu.Lock()
    defer c.mu.Unlock()

    c.items[key] = CacheItem{
        Value:      value,
        Expiration: time.Now().Add(ttl),
    }
}

func (c *InMemoryCache) Get(key string) (interface{}, bool) {
    c.mu.RLock()
    defer c.mu.RUnlock()

    item, exists := c.items[key]
    if !exists {
        return nil, false
    }

    // Check if expired
    if time.Now().After(item.Expiration) {
        return nil, false
    }

    return item.Value, true
}

func (c *InMemoryCache) Delete(key string) {
    c.mu.Lock()
    defer c.mu.Unlock()
    delete(c.items, key)
}

func (c *InMemoryCache) cleanup() {
    ticker := time.NewTicker(1 * time.Minute)
    for range ticker.C {
        c.mu.Lock()
        for key, item := range c.items {
            if time.Now().After(item.Expiration) {
                delete(c.items, key)
            }
        }
        c.mu.Unlock()
    }
}
```

### 2. Usage Example

```go
func main() {
    cache := NewInMemoryCache()

    // Store user with 5 minute TTL
    user := User{ID: 1, Name: "Ahmed"}
    cache.Set("user:1", user, 5*time.Minute)

    // Retrieve
    if value, found := cache.Get("user:1"); found {
        user := value.(User)
        fmt.Printf("Found: %s\n", user.Name)
    } else {
        fmt.Println("Not found or expired")
    }
}
```

---

## 3ï¸âƒ£ When to Use Cache?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     When to Cache?                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  âœ… GOOD Candidates for Caching:                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                   â”‚
â”‚  â€¢ Read-heavy data (read >> write)                                  â”‚
â”‚  â€¢ Expensive computations                                           â”‚
â”‚  â€¢ External API responses                                           â”‚
â”‚  â€¢ Database query results                                           â”‚
â”‚  â€¢ Session data                                                     â”‚
â”‚  â€¢ Configuration settings                                           â”‚
â”‚  â€¢ Static content (images, CSS, JS)                                 â”‚
â”‚                                                                      â”‚
â”‚  âŒ BAD Candidates for Caching:                                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                    â”‚
â”‚  â€¢ Write-heavy data                                                 â”‚
â”‚  â€¢ Real-time data (stock prices, live scores)                       â”‚
â”‚  â€¢ Highly personalized data                                         â”‚
â”‚  â€¢ Security-sensitive data (careful!)                               â”‚
â”‚  â€¢ Data that must be 100% consistent                                â”‚
â”‚                                                                      â”‚
â”‚  âš ï¸ Cache with Caution:                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                              â”‚
â”‚  â€¢ User-specific data                                               â”‚
â”‚  â€¢ Frequently updated data                                          â”‚
â”‚  â€¢ Data with strict consistency requirements                        â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Decision Tree

```
                    Should I cache this?
                           â”‚
                           â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Is it read frequently? â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚           â”‚
                   Yes          No
                    â”‚           â”‚
                    â–¼           â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    Don't cache
        â”‚ Is it expensive â”‚
        â”‚ to compute/fetch?â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚       â”‚
             Yes      No
              â”‚       â”‚
              â–¼       â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  Consider caching
    â”‚ Is staleness  â”‚  (low priority)
    â”‚ acceptable?   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚       â”‚
         Yes      No
          â”‚       â”‚
          â–¼       â–¼
       CACHE!   Don't cache
    (with TTL)  (or very short TTL)
```

---

## 4ï¸âƒ£ Cache Problems

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Common Cache Problems                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  1. Stale Data (Ø¨ÙŠØ§Ù†Ø§Øª Ù‚Ø¯ÙŠÙ…Ø©)                                       â”‚
â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                     â”‚
â”‚     Problem: Cache contains outdated data                           â”‚
â”‚     Solution: TTL, Cache invalidation                               â”‚
â”‚                                                                      â”‚
â”‚  2. Cache Stampede (ØªØ¯Ø§ÙØ¹ Ø¹Ù„Ù‰ Ø§Ù„Ù€ Cache)                            â”‚
â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                             â”‚
â”‚     Problem: Many requests hit DB when cache expires                â”‚
â”‚     Solution: Locking, Staggered TTL                                â”‚
â”‚                                                                      â”‚
â”‚  3. Cold Start (Ø¨Ø¯Ø§ÙŠØ© Ø¨Ø§Ø±Ø¯Ø©)                                        â”‚
â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                        â”‚
â”‚     Problem: Empty cache after restart                              â”‚
â”‚     Solution: Cache warming                                         â”‚
â”‚                                                                      â”‚
â”‚  4. Memory Pressure (Ø¶ØºØ· Ø§Ù„Ø°Ø§ÙƒØ±Ø©)                                   â”‚
â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                     â”‚
â”‚     Problem: Cache uses too much memory                             â”‚
â”‚     Solution: Eviction policies (LRU, LFU)                          â”‚
â”‚                                                                      â”‚
â”‚  5. Thundering Herd (Ø§Ù„Ù‚Ø·ÙŠØ¹ Ø§Ù„ØµØ§Ø®Ø¨)                                  â”‚
â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                 â”‚
â”‚     Problem: All servers invalidate cache simultaneously            â”‚
â”‚     Solution: Randomized TTL                                        â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Cache Stampede Example

```
Time 0: Cache expires for "popular_products"

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Request 1â”‚     â”‚ Request 2â”‚     â”‚ Request 3â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                â”‚                â”‚
     â–¼                â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Cache                       â”‚
â”‚              "Miss! Empty!"                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                â”‚                â”‚
     â–¼                â–¼                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 Database                     â”‚
â”‚     3 identical queries! â†’ Overload!        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Solution: Only ONE request queries DB, others wait
```

---

## 5ï¸âƒ£ Eviction Policies

<div dir="rtl">

Ø¹Ù†Ø¯Ù…Ø§ Ø§Ù„Ù€ Cache ÙŠÙ…ØªÙ„Ø¦ØŒ Ù„Ø§Ø²Ù… Ù†Ø­Ø°Ù Ø¨Ø¹Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª. ÙÙŠ Ø¹Ø¯Ø© Ø·Ø±Ù‚:

</div>

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Eviction Policies                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  1. LRU (Least Recently Used)                                       â”‚
â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                        â”‚
â”‚     ÙŠØ­Ø°Ù Ø§Ù„Ù€ item Ø§Ù„Ù„ÙŠ Ù…Ø± Ø¹Ù„ÙŠÙ‡ Ø£Ø·ÙˆÙ„ ÙˆÙ‚Øª Ø¨Ø¯ÙˆÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù…                â”‚
â”‚     Ø§Ù„Ø£ÙƒØ«Ø± Ø´ÙŠÙˆØ¹Ø§Ù‹ ÙˆØ§Ø³ØªØ®Ø¯Ø§Ù…Ø§Ù‹                                        â”‚
â”‚                                                                      â”‚
â”‚     Access history: A â†’ B â†’ C â†’ D â†’ A â†’ E                           â”‚
â”‚     Full? Delete B (oldest not accessed)                            â”‚
â”‚                                                                      â”‚
â”‚  2. LFU (Least Frequently Used)                                     â”‚
â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                     â”‚
â”‚     ÙŠØ­Ø°Ù Ø§Ù„Ù€ item Ø§Ù„Ù„ÙŠ Ø§Ø³ØªÙØ®Ø¯Ù… Ø£Ù‚Ù„ Ø¹Ø¯Ø¯ Ù…Ø±Ø§Øª                         â”‚
â”‚                                                                      â”‚
â”‚     Counts: A(10) B(2) C(50) D(3)                                   â”‚
â”‚     Full? Delete B (least count)                                    â”‚
â”‚                                                                      â”‚
â”‚  3. FIFO (First In, First Out)                                      â”‚
â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                       â”‚
â”‚     ÙŠØ­Ø°Ù Ø§Ù„Ø£Ù‚Ø¯Ù… Ø¨ØºØ¶ Ø§Ù„Ù†Ø¸Ø± Ø¹Ù† Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…                              â”‚
â”‚                                                                      â”‚
â”‚  4. TTL (Time To Live)                                              â”‚
â”‚     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                             â”‚
â”‚     ÙŠØ­Ø°Ù Ø¨Ø¹Ø¯ Ù…Ø±ÙˆØ± ÙˆÙ‚Øª Ù…Ø­Ø¯Ø¯                                          â”‚
â”‚     Ø§Ù„Ø£ÙƒØ«Ø± Ø§Ø³ØªØ®Ø¯Ø§Ù…Ø§Ù‹ Ù…Ø¹ Redis                                       â”‚
â”‚                                                                      â”‚
â”‚  5. Random                                                          â”‚
â”‚     â”€â”€â”€â”€â”€â”€                                                           â”‚
â”‚     ÙŠØ­Ø°Ù Ø¹Ø´ÙˆØ§Ø¦ÙŠØ§Ù‹ (Ø¨Ø³ÙŠØ· Ù„ÙƒÙ† ØºÙŠØ± ÙØ¹Ø§Ù„)                               â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### LRU Implementation (Simplified)

```go
type LRUCache struct {
    capacity int
    items    map[string]*list.Element
    order    *list.List
    mu       sync.Mutex
}

type entry struct {
    key   string
    value interface{}
}

func NewLRUCache(capacity int) *LRUCache {
    return &LRUCache{
        capacity: capacity,
        items:    make(map[string]*list.Element),
        order:    list.New(),
    }
}

func (c *LRUCache) Get(key string) (interface{}, bool) {
    c.mu.Lock()
    defer c.mu.Unlock()

    if elem, ok := c.items[key]; ok {
        // Move to front (recently used)
        c.order.MoveToFront(elem)
        return elem.Value.(*entry).value, true
    }
    return nil, false
}

func (c *LRUCache) Set(key string, value interface{}) {
    c.mu.Lock()
    defer c.mu.Unlock()

    if elem, ok := c.items[key]; ok {
        // Update and move to front
        c.order.MoveToFront(elem)
        elem.Value.(*entry).value = value
        return
    }

    // Evict if at capacity
    if c.order.Len() >= c.capacity {
        oldest := c.order.Back()
        if oldest != nil {
            c.order.Remove(oldest)
            delete(c.items, oldest.Value.(*entry).key)
        }
    }

    // Add new item at front
    elem := c.order.PushFront(&entry{key, value})
    c.items[key] = elem
}
```

---

## 6ï¸âƒ£ Cache Layers in Web Application

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Multi-Layer Caching                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  Layer 1: Browser Cache (HTTP Caching)                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                            â”‚
â”‚  â€¢ Static assets (JS, CSS, images)                                  â”‚
â”‚  â€¢ API responses (with cache headers)                               â”‚
â”‚  â€¢ Controlled via: Cache-Control, ETag, Last-Modified              â”‚
â”‚                                                                      â”‚
â”‚  Layer 2: CDN Cache                                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                   â”‚
â”‚  â€¢ Edge servers worldwide                                           â”‚
â”‚  â€¢ Reduces latency for users                                        â”‚
â”‚  â€¢ Cloudflare, AWS CloudFront, etc.                                â”‚
â”‚                                                                      â”‚
â”‚  Layer 3: Application Cache (Redis)                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                â”‚
â”‚  â€¢ Session data                                                     â”‚
â”‚  â€¢ Database query results                                           â”‚
â”‚  â€¢ Computed values                                                  â”‚
â”‚                                                                      â”‚
â”‚  Layer 4: Database Cache                                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                           â”‚
â”‚  â€¢ Query cache (MySQL)                                              â”‚
â”‚  â€¢ Buffer pool                                                      â”‚
â”‚  â€¢ Managed automatically                                            â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… Key Takeaways

<div dir="rtl">

- âœ… **Caching** = ØªØ®Ø²ÙŠÙ† Ù…Ø¤Ù‚Øª Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© Ø¨ÙƒØ«Ø±Ø©
- âœ… **Cache Hit** = Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…ÙˆØ¬ÙˆØ¯Ø© (Ø³Ø±ÙŠØ¹)
- âœ… **Cache Miss** = Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© (Ø¨Ø·ÙŠØ¡)
- âœ… **TTL** = ÙˆÙ‚Øª Ø§Ù†ØªÙ‡Ø§Ø¡ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
- âœ… **LRU** = Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø­Ø°Ù Ø§Ù„Ø£ÙƒØ«Ø± Ø´ÙŠÙˆØ¹Ø§Ù‹
- âœ… Cache Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª **read-heavy** ÙÙ‚Ø·
- âœ… Cache **Ù„ÙŠØ³** Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª real-time Ø£Ùˆ sensitive

</div>

---

## â­ï¸ Next Lesson

<div dir="rtl">

Ø§Ù„Ø¢Ù† Ø¨Ø¹Ø¯ Ù…Ø§ ÙÙ‡Ù…Øª Ø£Ø³Ø§Ø³ÙŠØ§Øª Ø§Ù„Ù€ CachingØŒ Ø®Ù„ÙŠÙ†Ø§ Ù†ØªØ¹Ù„Ù… Ø¹Ù† Ø§Ù„Ù€ Strategies Ø§Ù„Ù…Ø®ØªÙ„ÙØ©:

**â¡ï¸ [Lesson 2: Caching Strategies](./02-caching-strategies.md)**

</div>

---

<div align="center">

[ğŸ“š Module Home](../README.md) | [â¡ï¸ Next: Caching Strategies](./02-caching-strategies.md)

</div>
